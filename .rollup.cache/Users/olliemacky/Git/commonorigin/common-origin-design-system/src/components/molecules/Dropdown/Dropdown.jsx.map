{"version":3,"file":"Dropdown.jsx","sourceRoot":"","sources":["Dropdown.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from 'react'\nimport styled from 'styled-components'\nimport tokens from '@/styles/tokens.json'\nimport { Icon } from '../../atoms/Icon'\nimport { Typography } from '../../atoms/Typography'\n\nconst { base: { spacing, shadow, zIndex }, semantic: { color, typography, border } } = tokens\n\ninterface DropdownOption {\n  id: string\n  label: string\n  value?: any\n}\n\nexport interface DropdownProps {\n  options: DropdownOption[]\n  value: string\n  onChange: (value: string) => void\n  placeholder?: string\n  disabled?: boolean\n  className?: string\n  label?: string\n}\n\nconst DropdownContainer = styled.div`\n  position: relative;\n  width: 100%;\n`\n\nconst DropdownTrigger = styled.button.withConfig({\n  shouldForwardProp: (prop) => !['$isOpen'].includes(prop),\n})<{ $isOpen: boolean }>`\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: ${spacing[3]} ${spacing[4]};\n  background-color: ${color.background.default};\n  border: ${border.default};\n  border-radius: ${tokens.base.border.radius[2]};\n  font: ${typography.body};\n  color: ${color.text.default};\n  cursor: pointer;\n  transition: all 0.15s ease;\n  \n  &:hover {\n    background-color: ${color.background.surface};\n    border-color: ${color.border.strong};\n  }\n  \n  &:focus {\n    outline: ${tokens.semantic.border.focus};\n    outline-offset: 2px;\n  }\n  \n  &:disabled {\n    background-color: ${color.background.disabled};\n    color: ${color.text.disabled};\n    cursor: not-allowed;\n    border-color: ${color.border.subtle};\n  }\n  \n  ${({ $isOpen }) => $isOpen && `\n    background-color: ${color.background.surface};\n    border-color: ${color.border.strong};\n  `}\n`\n\nconst DropdownIcon = styled.div.withConfig({\n  shouldForwardProp: (prop) => !['$isOpen'].includes(prop),\n})<{ $isOpen: boolean }>`\n  display: flex;\n  align-items: center;\n  margin-left: ${spacing[2]};\n  transition: transform 0.15s ease;\n  \n  ${({ $isOpen }) => $isOpen && `\n    transform: rotate(180deg);\n  `}\n`\n\nconst DropdownMenu = styled.div.withConfig({\n  shouldForwardProp: (prop) => !['$isOpen'].includes(prop),\n})<{ $isOpen: boolean }>`\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  z-index: ${zIndex[3]};\n  background-color: ${color.background.default};\n  border: ${border.default};\n  border-radius: ${tokens.base.border.radius[2]};\n  box-shadow: ${shadow[3]};\n  margin-top: ${spacing[1]};\n  overflow: hidden;\n  opacity: ${({ $isOpen }) => ($isOpen ? 1 : 0)};\n  visibility: ${({ $isOpen }) => ($isOpen ? 'visible' : 'hidden')};\n  transform: ${({ $isOpen }) => ($isOpen ? 'translateY(0)' : 'translateY(-8px)')};\n  transition: all 0.15s ease;\n  max-height: 300px;\n  overflow-y: auto;\n`\n\nconst DropdownOption = styled.button.withConfig({\n  shouldForwardProp: (prop) => !['$isSelected', '$isFocused'].includes(prop),\n})<{ $isSelected: boolean; $isFocused: boolean }>`\n  width: 100%;\n  display: block;\n  padding: ${spacing[3]} ${spacing[4]};\n  background-color: ${({ $isSelected, $isFocused }) => {\n    if ($isFocused) return color.background.surface\n    if ($isSelected) return color.background.surface\n    return 'transparent'\n  }};\n  border: none;\n  font: ${typography.body};\n  color: ${color.text.default};\n  text-align: left;\n  cursor: pointer;\n  transition: background-color 0.15s ease;\n  \n  &:hover {\n    background-color: ${color.background.surface};\n  }\n  \n  &:focus {\n    outline: none;\n    background-color: ${color.background.surface};\n  }\n  \n  &:not(:last-child) {\n    border-bottom: ${border.subtle};\n  }\n`\n\nexport const Dropdown: React.FC<DropdownProps> = ({\n  options,\n  value,\n  onChange,\n  placeholder = 'Select an option',\n  disabled = false,\n  className,\n  label\n}) => {\n  const [isOpen, setIsOpen] = useState(false)\n  const [focusedIndex, setFocusedIndex] = useState(-1)\n  const dropdownRef = useRef<HTMLDivElement>(null)\n  \n  // Generate unique ID for accessibility\n  const dropdownId = useRef(`dropdown-${Math.random().toString(36).substr(2, 9)}`).current\n  \n  const selectedOption = options.find(option => option.id === value)\n  \n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false)\n      }\n    }\n    \n    document.addEventListener('mousedown', handleClickOutside)\n    return () => document.removeEventListener('mousedown', handleClickOutside)\n  }, [])\n  \n  // Close dropdown on escape key and handle arrow navigation\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (!isOpen) return\n\n      switch (event.key) {\n        case 'Escape':\n          setIsOpen(false)\n          setFocusedIndex(-1)\n          // Return focus to trigger button\n          if (dropdownRef.current) {\n            const trigger = dropdownRef.current.querySelector('button') as HTMLButtonElement\n            trigger?.focus()\n          }\n          break\n        \n        case 'ArrowDown':\n          event.preventDefault()\n          setFocusedIndex(prev => {\n            const newIndex = prev < options.length - 1 ? prev + 1 : 0\n            return newIndex\n          })\n          break\n        \n        case 'ArrowUp':\n          event.preventDefault()\n          setFocusedIndex(prev => {\n            const newIndex = prev > 0 ? prev - 1 : options.length - 1\n            return newIndex\n          })\n          break\n        \n        case 'Enter':\n        case ' ':\n          event.preventDefault()\n          if (focusedIndex >= 0 && focusedIndex < options.length) {\n            handleOptionClick(options[focusedIndex].id)\n          }\n          break\n        \n        case 'Home':\n          event.preventDefault()\n          setFocusedIndex(0)\n          break\n        \n        case 'End':\n          event.preventDefault()\n          setFocusedIndex(options.length - 1)\n          break\n      }\n    }\n    \n    if (isOpen) {\n      document.addEventListener('keydown', handleKeyDown)\n      return () => document.removeEventListener('keydown', handleKeyDown)\n    }\n    \n    return undefined\n  }, [isOpen, focusedIndex, options])\n  \n  const handleTriggerClick = () => {\n    if (!disabled) {\n      setIsOpen(!isOpen)\n      if (!isOpen) {\n        // When opening, set focus to the currently selected option or first option\n        const selectedIndex = options.findIndex(option => option.id === value)\n        setFocusedIndex(selectedIndex >= 0 ? selectedIndex : 0)\n      } else {\n        // When closing, reset focus\n        setFocusedIndex(-1)\n      }\n    }\n  }\n  \n  const handleOptionClick = (optionId: string) => {\n    onChange(optionId)\n    setIsOpen(false)\n    setFocusedIndex(-1)\n  }\n  \n  return (\n    <DropdownContainer ref={dropdownRef} className={className}>\n      {label && (\n        <label htmlFor={dropdownId} style={{ display: 'block', marginBottom: spacing[2] }}>\n          <Typography variant=\"label\">{label}</Typography>\n        </label>\n      )}\n      <DropdownTrigger\n        id={dropdownId}\n        $isOpen={isOpen}\n        onClick={handleTriggerClick}\n        disabled={disabled}\n        aria-expanded={isOpen}\n        aria-haspopup=\"listbox\"\n      >\n        <span>{selectedOption ? selectedOption.label : placeholder}</span>\n        <DropdownIcon $isOpen={isOpen}>\n          <Icon name=\"arrowDown\" iconColor={disabled ? 'disabled' : 'subdued'} />\n        </DropdownIcon>\n      </DropdownTrigger>\n      \n      <DropdownMenu $isOpen={isOpen} role=\"listbox\">{options.map((option, index) => (\n          <DropdownOption\n            key={option.id}\n            $isSelected={option.id === value}\n            $isFocused={index === focusedIndex}\n            onClick={() => handleOptionClick(option.id)}\n            role=\"option\"\n            aria-selected={option.id === value}\n          >\n            {option.label}\n          </DropdownOption>\n        ))}\n      </DropdownMenu>\n    </DropdownContainer>\n  )\n}\n"]}